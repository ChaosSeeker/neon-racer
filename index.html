<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Neon Racer 3D</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>

<body class="home-mode">
  <div id="app">
    <canvas id="game"></canvas>

    <!-- TOPBAR -->
    <div class="topbar">
      <div class="brand">
        <h1>NEON RACER 3D</h1>
        <div class="sub">3D universe â€¢ Tap Play to start the run</div>
      </div>

      <div class="actions">
        <span class="chip">Player: <b id="chipPlayer">Gamer</b></span>
        <span class="chip">Rank <b id="chipRank">Rookie</b></span>
        <span class="chip">Bank ğŸª™ <b id="chipBank">0</b></span>
        <span class="chip">Best <b id="chipBest">0</b></span>

        <button id="btn-audio" class="btn small" title="Toggle audio">ğŸ”Š</button>
        <button id="btn-fullscreen" class="btn small" title="Fullscreen">â›¶</button>
        <button id="btn-play-top" class="btn primary small" title="Play">â–¶ Play</button>
      </div>
    </div>

    <!-- HUD -->
    <div id="hud" class="hud">
      <div class="hudLeft">
        <div class="pill">Score <b id="score">0</b></div>
        <div class="pill">Combo <b id="combo">x1</b></div>
        <div class="pill">Run ğŸª™ <b id="coins">0</b></div>

        <div class="pill">Lives â¤ï¸ <b id="lives">2</b></div>
        <div class="pill">Nitro âš¡ <b id="nitro">1</b></div>
        <div class="pill">Drift ğŸŒ€ <b id="drift">0%</b></div>

        <div class="pill" id="pillBonus">Bonus â± <b id="bonus">â€”</b></div>
        <div class="pill" id="pillGhost">Ghost ğŸ‘» <b id="ghost">OFF</b></div>
      </div>

      <div class="hudRight">
        <button id="btn-menu" class="menuBtn" title="Menu">â˜°</button>
      </div>
    </div>

    <!-- HOME -->
    <div id="home" class="home visible">
      <div class="hero">
        <div class="heroRow">
          <div>
            <p class="heroTitle">Race. Dodge. Collect. Flex your rank.</p>
            <p class="muted">Free movement, real 3D cars, starfield universe, lane-switching traffic AI, bonus rounds + revive.</p>
          </div>

          <div class="row">
            <button id="btn-play" class="btn primary">â–¶ Play</button>
            <button id="btn-how" class="btn">ğŸ“˜ How to Play</button>
            <button id="btn-feedback" class="btn">ğŸ’¬ Feedback</button>
          </div>
        </div>

        <!-- NEW: PLAYER NAME -->
        <div class="card" style="margin-bottom:12px;">
          <h3>Your Name (for leaderboard)</h3>
          <p class="muted">Set once â€” you can change it anytime.</p>
          <div class="row">
            <input id="nameInput" class="nameInput" maxlength="18" placeholder="Enter your nameâ€¦" />
            <button id="btn-save-name" class="btn primary small">Save</button>
            <span class="chip">Current: <b id="namePreview">Gamer</b></span>
          </div>
        </div>

        <div class="heroGrid">

          <div class="card">
            <h3>Daily Reward</h3>
            <p class="muted">Claim once per day. Build streak for bigger rewards.</p>
            <div class="row">
              <button id="btn-reward" class="btn">ğŸ Claim</button>
              <span class="chip">Streak: <b id="rewardStreak">0</b>/7</span>
              <span class="chip">Today: <b id="rewardAmt">0</b>ğŸª™</span>
            </div>
          </div>

          <div class="card">
            <h3>Daily Crate</h3>
            <p class="muted">Free daily roll. Unlock skins.</p>
            <div class="row">
              <button id="btn-crate" class="btn">ğŸ“¦ Open</button>
              <span class="chip">Result: <b id="crateOut">â€”</b></span>
            </div>
          </div>

          <div class="card">
            <h3>Daily Tasks</h3>
            <p class="muted">3 tasks refresh daily. Earn coins for consistency.</p>
            <div id="missions" class="missions"></div>
            <div class="row">
              <button id="btn-refresh-missions" class="btn small">â†» Refresh</button>
              <span class="chip">Bonus: <b id="missionsBonus">0</b>ğŸª™</span>
            </div>
          </div>

          <div class="card">
            <h3>Shop</h3>
            <p class="muted">Buy run-boosters. Applied automatically when you start.</p>
            <div class="shop">
              <div class="shopItem">
                <div class="sTitle">Magnet</div><div class="muted small">+6s</div>
                <button class="btn small" data-buy="magnet">Buy 120ğŸª™</button>
              </div>
              <div class="shopItem">
                <div class="sTitle">Shield</div><div class="muted small">+5s</div>
                <button class="btn small" data-buy="shield">Buy 140ğŸª™</button>
              </div>
              <div class="shopItem">
                <div class="sTitle">Score x2</div><div class="muted small">+7s</div>
                <button class="btn small" data-buy="scorex2">Buy 160ğŸª™</button>
              </div>
              <div class="shopItem">
                <div class="sTitle">Nitro</div><div class="muted small">+1 charge</div>
                <button class="btn small" data-buy="nitro">Buy 180ğŸª™</button>
              </div>
              <div class="shopItem">
                <div class="sTitle">Slowmo</div><div class="muted small">+4s</div>
                <button class="btn small" data-buy="slowmo">Buy 160ğŸª™</button>
              </div>
              <div class="shopItem">
                <div class="sTitle">Invisibility</div><div class="muted small">+4s</div>
                <button class="btn small" data-buy="invis">Buy 180ğŸª™</button>
              </div>
            </div>
            <div class="row">
              <span class="chip">Queued: <b id="shopQueued">â€”</b></span>
              <button id="btn-clear-queued" class="btn small">Clear</button>
            </div>
          </div>

          <div class="card">
            <h3>Skins</h3>
            <p class="muted">Your car preview updates in the 3D garage.</p>
            <div id="skins" class="skins"></div>
          </div>

          <div class="card">
            <h3>Leaderboard</h3>
            <p class="muted">Submit your best. Challenge seeds can be shared.</p>
            <div id="lb" class="lb"></div>
            <div class="row">
              <button id="btn-submit" class="btn small">Submit Best</button>
              <button id="btn-refresh" class="btn small">Refresh</button>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- HOW -->
    <div id="howPanel" class="modal">
      <div class="panel">
        <h2>How to Play</h2>
        <ul>
          <li><b>Move:</b> WASD / Arrow Keys / Mobile Joystick / Swipe-drag</li>
          <li><b>Nitro:</b> Space</li>
          <li><b>Drift:</b> Hold Shift + steer</li>
          <li><b>Goal:</b> Dodge traffic, collect coins, keep combo.</li>
          <li><b>Bonus Round:</b> Coin-heavy section, no obstacle spawns.</li>
          <li><b>Revive:</b> Once per run for 100 coins.</li>
        </ul>
        <div class="row">
          <button id="btn-how-close" class="btn primary">OK</button>
        </div>
      </div>
    </div>

    <div id="countdown" class="overlay">
      <div class="count">3</div>
    </div>

    <div id="menu" class="overlay">
      <div class="panel">
        <h2>Paused</h2>
        <p class="sub muted">Resume or return home.</p>
        <div class="row">
          <button id="btn-resume" class="btn primary">Resume</button>
          <button id="btn-home2" class="btn">Home</button>
        </div>
      </div>
    </div>

    <div id="gameover" class="overlay">
      <div class="panel">
        <h2>Game Over</h2>
        <p class="sub">Score: <b id="finalScore">0</b> â€¢ Run Coins: <b id="finalCoins">0</b></p>

        <div class="row">
          <button id="btn-revive" class="btn primary">Revive (100ğŸª™)</button>
          <button id="btn-restart" class="btn">Restart</button>
          <button id="btn-home" class="btn">Home</button>
        </div>

        <div class="divider"></div>

        <div class="row">
          <button id="btn-share" class="btn">Share Challenge</button>
          <button id="btn-submit2" class="btn">Submit Best</button>
        </div>

        <div id="shareOut" class="shareOut"></div>
      </div>
    </div>

    <div id="toast" class="toast"></div>

    <!-- Mobile Joystick -->
    <div id="joy" class="joy hidden">
      <div class="joy-base"></div>
      <div class="joy-knob"></div>
    </div>

  </div>

  <script type="module" src="./js/main.js"></script>

  <script>
    window.addEventListener("DOMContentLoaded", () => {
      const top = document.getElementById("btn-play-top");
      const play = document.getElementById("btn-play");
      if (top && play) top.addEventListener("click", () => play.click());
    });
  </script>
</body>
</html>
